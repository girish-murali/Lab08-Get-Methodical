import java.util.Scanner;

public class SafeInput
{
    /**
     * Part A: getNonZeroLenString
     * Prompts the user for a String and ensures it is not a zero-length (blank) String.
     * @param pipe a Scanner opened to read from System.in
     * @param prompt prompt for the user
     * @return a String response that is not zero length
     */
    public static String getNonZeroLenString(Scanner pipe, String prompt)
    {
        String retString = ""; // Set this to zero length. Loop runs until it isn't
        do
        {
            System.out.print("\n" +prompt + ": "); // show prompt add space
            retString = pipe.nextLine();
        }while(retString.length() == 0);

        return retString;
    }

    /**
     * Part B: getInt
     * Prompts the user for an integer and loops until valid integer input is received.
     * Bullet-proofs input using hasNext methods and clearing the pipe (newline fix).
     * @param pipe   The Scanner object used for input.
     * @param prompt The message to display to the user.
     * @return The validated integer input.
     */
    public static int getInt(Scanner pipe, String prompt)
    {
        int retInt = 0;
        String trash = "";
        boolean done = false;

        do
        {
            System.out.print("\n" + prompt + ": ");
            if(pipe.hasNextInt())
            {
                retInt = pipe.nextInt();
                pipe.nextLine(); // Clear the newline from the buffer [cite: 80]
                done = true;
            }
            else
            {
                trash = pipe.nextLine(); // Read the trash [cite: 80]
                System.out.println("Invalid input: " + trash + ". You must enter an integer.");
            }
        } while(!done);

        return retInt;
    }

    /**
     * Part C: getDouble
     * Prompts the user for a double and loops until valid double input is received.
     * Bullet-proofs input using hasNext methods and clearing the pipe (newline fix).
     * @param pipe   The Scanner object used for input.
     * @param prompt The message to display to the user.
     * @return The validated double input.
     */
    public static double getDouble(Scanner pipe, String prompt)
    {
        double retDouble = 0;
        String trash = "";
        boolean done = false;

        do
        {
            System.out.print("\n" + prompt + ": ");
            if(pipe.hasNextDouble())
            {
                retDouble = pipe.nextDouble();
                pipe.nextLine(); // Clear the newline from the buffer [cite: 87]
                done = true;
            }
            else
            {
                trash = pipe.nextLine(); // Read the trash [cite: 87]
                System.out.println("Invalid input: " + trash + ". You must enter a double value.");
            }
        } while(!done);

        return retDouble;
    }

    /**
     * Part D: getRangedInt
     * Prompts the user for an integer within a specified inclusive range [low, high].
     * Appends the range to the user-supplied prompt[cite: 98].
     * @param pipe   The Scanner object used for input.
     * @param prompt The message to display to the user.
     * @param low    The minimum valid integer (inclusive)[cite: 93].
     * @param high   The maximum valid integer (inclusive)[cite: 93].
     * @return The validated integer within the specified range.
     */
    public static int getRangedInt(Scanner pipe, String prompt, int low, int high)
    {
        int retInt = 0;
        String trash = "";
        boolean done = false;
        String fullPrompt = prompt + " [" + low + " - " + high + "]: "; // Append range to prompt [cite: 98]

        do
        {
            System.out.print("\n" + fullPrompt);
            if(pipe.hasNextInt())
            {
                retInt = pipe.nextInt();
                pipe.nextLine(); // Clear the newline from the buffer

                if(retInt >= low && retInt <= high)
                {
                    done = true;
                }
                else
                {
                    System.out.println("Invalid input: " + retInt + ". Must be within the inclusive range [" + low + " - " + high + "]");
                }
            }
            else
            {
                trash = pipe.nextLine();
                System.out.println("Invalid input: " + trash + ". You must enter an integer.");
            }
        } while(!done);

        return retInt;
    }

    /**
     * Part E: getRangedDouble
     * Prompts the user for a double within a specified inclusive range [low, high].
     * Appends the range to the user-supplied prompt[cite: 107].
     * @param pipe   The Scanner object used for input.
     * @param prompt The message to display to the user.
     * @param low    The minimum valid double (inclusive).
     * @param high   The maximum valid double (inclusive).
     * @return The validated double within the specified range.
     */
    public static double getRangedDouble(Scanner pipe, String prompt, double low, double high)
    {
        double retDouble = 0;
        String trash = "";
        boolean done = false;
        String fullPrompt = prompt + " [" + low + " - " + high + "]: "; // Append range to prompt [cite: 107]

        do
        {
            System.out.print("\n" + fullPrompt);
            if(pipe.hasNextDouble())
            {
                retDouble = pipe.nextDouble();
                pipe.nextLine(); // Clear the newline from the buffer

                if(retDouble >= low && retDouble <= high)
                {
                    done = true;
                }
                else
                {
                    System.out.println("Invalid input: " + retDouble + ". Must be within the inclusive range [" + low + " - " + high + "]");
                }
            }
            else
            {
                trash = pipe.nextLine();
                System.out.println("Invalid input: " + trash + ". You must enter a double value.");
            }
        } while(!done);

        return retDouble;
    }

    /**
     * Part F: getYNConfirm
     * Prompts for a Yes or No input, accepts 'y', 'Y', 'n', or 'N'[cite: 113].
     * Returns true for 'Y'/'y' and false for 'N'/'n'[cite: 112].
     * @param pipe   The Scanner object used for input.
     * @param prompt The message to display to the user.
     * @return true if 'Y' or 'y' is entered, false if 'N' or 'n' is entered.
     */
    public static boolean getYNConfirm(Scanner pipe, String prompt)
    {
        String retString = "";
        boolean done = false;
        boolean confirmation = false;
        String fullPrompt = prompt + " [Y/N]: ";

        do
        {
            System.out.print("\n" + fullPrompt);
            retString = pipe.nextLine().trim();

            if (retString.equalsIgnoreCase("Y"))
            {
                confirmation = true;
                done = true;
            }
            else if (retString.equalsIgnoreCase("N"))
            {
                confirmation = false;
                done = true;
            }
            else
            {
                System.out.println("Invalid input: " + retString + ". You must enter 'Y' (Yes) or 'N' (No).");
            }
        } while (!done);

        return confirmation;
    }

    /**
     * Part G: getRegExString
     * Prompts the user for a String that must match a specified Java RegEx pattern[cite: 120, 124].
     * @param pipe   The Scanner object used for input.
     * @param prompt The message to display to the user.
     * @param regEx  The regular expression pattern the input must match.
     * @return The validated String that matches the RegEx pattern.
     */
    public static String getRegExString(Scanner pipe, String prompt, String regEx)
    {
        String retString = "";
        boolean done = false;
        String displayRegEx = regEx.replace("\\", "\\\\"); // Prepare RegEx for better display
        String fullPrompt = prompt + " (Pattern: " + displayRegEx + "): ";

        do
        {
            System.out.print("\n" + fullPrompt);
            retString = pipe.nextLine();

            if (retString.matches(regEx))
            {
                done = true;
            }
            else
            {
                System.out.println("Invalid input. The input: '" + retString + "' must match the pattern: " + regEx);
            }
        } while (!done);

        return retString;
    }
}
