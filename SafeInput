import java.util.Scanner;

/**
 * A library of static methods for safe user input validation,
 * created for Lab 08: Get Methodical.
 */
public class SafeInput
{
    /**
     * [cite_start]Part A: getNonZeroLenString [cite: 54]
     * Prompts the user for a String and ensures it is not a zero-length (blank) String.
     * @param pipe a Scanner opened to read from System.in
     * @param prompt prompt for the user
     * @return a String response that is not zero length
     */
    public static String getNonZeroLenString(Scanner pipe, String prompt)
    {
        String retString = "";
        do
        {
            System.out.print("\n" +prompt + ": ");
            retString = pipe.nextLine();
        }while(retString.length() == 0);
        return retString;
    }

    /**
     * [cite_start]Part B: getInt [cite: 78]
     * Prompts the user for any integer, handling non-numeric input.
     */
    public static int getInt(Scanner pipe, String prompt)
    {
        int retInt = 0;
        String trash = "";
        boolean done = false;

        do
        {
            System.out.print("\n" + prompt + ": ");
            if(pipe.hasNextInt())
            {
                retInt = pipe.nextInt();
                pipe.nextLine(); // Clear the newline
                done = true;
            }
            else
            {
                trash = pipe.nextLine(); 
                System.out.println("Invalid input: " + trash + ". You must enter an integer.");
            }
        } while(!done);

        return retInt;
    }

    /**
     * [cite_start]Part C: getDouble [cite: 85]
     * Prompts the user for any double value, handling non-numeric input.
     */
    public static double getDouble(Scanner pipe, String prompt)
    {
        double retDouble = 0;
        String trash = "";
        boolean done = false;

        do
        {
            System.out.print("\n" + prompt + ": ");
            if(pipe.hasNextDouble())
            {
                retDouble = pipe.nextDouble();
                pipe.nextLine(); // Clear the newline
                done = true;
            }
            else
            {
                trash = pipe.nextLine();
                System.out.println("Invalid input: " + trash + ". You must enter a double value.");
            }
        } while(!done);

        return retDouble;
    }

    /**
     * [cite_start]Part D: getRangedInt [cite: 92]
     * Prompts the user for an integer within a specified inclusive range [low, high].
     */
    public static int getRangedInt(Scanner pipe, String prompt, int low, int high)
    {
        int retInt = 0;
        String trash = "";
        boolean done = false;
        String fullPrompt = prompt + " [" + low + " - " + high + "]: ";

        do
        {
            System.out.print("\n" + fullPrompt);
            if(pipe.hasNextInt())
            {
                retInt = pipe.nextInt();
                pipe.nextLine(); // Clear the newline

                if(retInt >= low && retInt <= high)
                {
                    done = true;
                }
                else
                {
                    System.out.println("Invalid input: " + retInt + ". Must be within the inclusive range [" + low + " - " + high + "]");
                }
            }
            else
            {
                trash = pipe.nextLine();
                System.out.println("Invalid input: " + trash + ". You must enter an integer.");
            }
        } while(!done);

        return retInt;
    }

    /**
     * [cite_start]Part E: getRangedDouble [cite: 102]
     * Prompts the user for a double within a specified inclusive range [low, high].
     */
    public static double getRangedDouble(Scanner pipe, String prompt, double low, double high)
    {
        double retDouble = 0;
        String trash = "";
        boolean done = false;
        String fullPrompt = prompt + " [" + low + " - " + high + "]: ";

        do
        {
            System.out.print("\n" + fullPrompt);
            if(pipe.hasNextDouble())
            {
                retDouble = pipe.nextDouble();
                pipe.nextLine(); // Clear the newline

                if(retDouble >= low && retDouble <= high)
                {
                    done = true;
                }
                else
                {
                    System.out.println("Invalid input: " + retDouble + ". Must be within the inclusive range [" + low + " - " + high + "]");
                }
            }
            else
            {
                trash = pipe.nextLine();
                System.out.println("Invalid input: " + trash + ". You must enter a double value.");
            }
        } while(!done);

        return retDouble;
    }

    /**
     * [cite_start]Part F: getYNConfirm [cite: 111]
     * Prompts for a Yes or No input, accepts 'y', 'Y', 'n', or 'N'. Returns true for 'Y'/'y'.
     */
    public static boolean getYNConfirm(Scanner pipe, String prompt)
    {
        String retString = "";
        boolean done = false;
        boolean confirmation = false;
        String fullPrompt = prompt + " [Y/N]: ";

        do
        {
            System.out.print("\n" + fullPrompt);
            retString = pipe.nextLine().trim();

            if (retString.equalsIgnoreCase("Y"))
            {
                confirmation = true;
                done = true;
            }
            else if (retString.equalsIgnoreCase("N"))
            {
                confirmation = false;
                done = true;
            }
            else
            {
                System.out.println("Invalid input: " + retString + ". You must enter 'Y' (Yes) or 'N' (No).");
            }
        } while (!done);

        return confirmation;
    }

    /**
     * [cite_start]Part G: getRegExString [cite: 119]
     * Prompts the user for a String that must match a specified Java RegEx pattern.
     */
    public static String getRegExString(Scanner pipe, String prompt, String regEx)
    {
        String retString = "";
        boolean done = false;
        String fullPrompt = prompt + " (Pattern: " + regEx + "): ";

        do
        {
            System.out.print("\n" + fullPrompt);
            retString = pipe.nextLine();

            if (retString.matches(regEx))
            {
                done = true;
            }
            else
            {
                System.out.println("Invalid input. The input: '" + retString + "' must match the pattern: " + regEx);
            }
        } while (!done);

        return retString;
    }

    /**
     * [cite_start]Part H (Program 06): prettyHeader [cite: 160]
     * Generates a centered, 60-character wide header with a message, using loops.
     * @param msg The string message to be centered.
     */
    public static void prettyHeader(String msg)
    {
        final int WIDTH = 60;
        final String STAR = "*";
        final String MESSAGE_DELIMITER = "***";
        int padding = 0;

        // Line 1: 60 stars
        for (int i = 0; i < WIDTH; i++)
        {
            System.out.print(STAR);
        }
        System.out.println(); // Newline

        // Line 2: Centered message (Width is 60. Delimiters take 6 spaces.)
        int availableSpace = WIDTH - (2 * MESSAGE_DELIMITER.length()); 
        int totalPadding = availableSpace - msg.length();
        padding = totalPadding / 2; 

        System.out.print(MESSAGE_DELIMITER);

        // Print left-side spaces
        for (int i = 0; i < padding; i++)
        {
            System.out.print(" ");
        }

        // Print the message
        System.out.print(msg);

        // Calculate right padding 
        // Ensures total width is exactly 60, accounting for odd/even centering
        int rightPadding = WIDTH - MESSAGE_DELIMITER.length() - padding - msg.length() - MESSAGE_DELIMITER.length();
        
        // Print right-side spaces
        for (int i = 0; i < rightPadding; i++)
        {
            System.out.print(" ");
        }

        System.out.println(MESSAGE_DELIMITER);

        // Line 3: 60 stars
        for (int i = 0; i < WIDTH; i++)
        {
            System.out.print(STAR);
        }
        System.out.println(); // Newline
    }
}
